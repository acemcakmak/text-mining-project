besides the fact that he is still disliked by professor snape ( alan rickman ) and hated by draco malfoy ( tom felton ) , harry gets off to a great start with his two best friends , ron weasly ( rupert grint ) and hermione granger ( emma watson ) , and famous writer gilderoy lockhart ( kenneth branagh ) has joined the hogwarts staff and is the new defense against the dark arts teacher .