Shares gain, but doubts linger on U.S.-China deal, oil rises